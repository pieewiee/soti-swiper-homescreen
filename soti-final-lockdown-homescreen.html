<!doctype html>
<html lang="en">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Company Name - SOTI Final Lockdown Homescreen</title>
    <meta name="viewport" content="width=device-width">

    <!-- BOOTSTRAP_CSS_PLACEHOLDER -->
    <!-- BOOTSTRAP_ICONS_PLACEHOLDER -->
    <!-- SWIPER_CSS_PLACEHOLDER -->

    <style>
        /* Brand Colors */
        :root {
            --bi-primary: #08312A;
            --bi-secondary: #00E47C;
            --bi-neutral: #E5E3DE;
            --bi-surface: #F6F5F3;
        }

        html,
        body {
            background: var(--bi-primary);
            height: 100%;
            margin: 0px;
            font-family: system-ui, -apple-system, sans-serif;
            overflow: hidden;
        }

        #wrapper {
            min-height: 100%;
            position: relative;
            display: flex;
            flex-direction: column;
        }

        a:link {
            text-decoration: none;
            color: inherit;
        }

        /* Header with BI Branding */
        #Header {
            background: var(--bi-primary);
            border-bottom: 3px solid var(--bi-secondary);
            width: 100%;
            position: fixed;
            top: 0px;
            z-index: 100;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 8px 16px;
        }

        #Header img {
            height: 40px;
            width: auto;
            border-radius: 4px;
        }

        #Header .Title {
            color: var(--bi-secondary);
            font-weight: bold;
            flex-grow: 1;
            text-align: center;
            margin: 0 16px;
        }

        #Header .logo {
            width: 40px;
            height: 40px;
            background: rgba(0, 228, 124, 0.1);
            border: 2px solid var(--bi-secondary);
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--bi-secondary);
            font-weight: bold;
            font-size: 14px;
        }

        #Header .info-btn {
            background: var(--bi-secondary);
            color: var(--bi-primary);
            border: 2px solid var(--bi-secondary);
            width: 36px;
            height: 36px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        #Header .info-btn:hover {
            background: white;
            transform: translateY(-1px);
        }

        /* Main content area */
        #Main {
            background: var(--bi-surface);
            flex: 1;
            position: relative;
            overflow: hidden;
        }

        #Main .content-wrapper {
            position: relative;
            z-index: 1;
            padding: 20px;
            height: 100%;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            box-sizing: border-box;
            overflow: hidden;
        }

        /* Swiper Container Wrapper - Forces smaller size */
        #Main .swiper-container-wrapper {
            flex: 1;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* Swiper Container - Now properly contained */
        #Main .swiper {
            flex: 1;
            width: 100%;
            max-width: 100%;
            height: 100%;
            overflow: hidden;
            box-sizing: border-box;
        }

        #Main .swiper-wrapper {
            height: 100%;
            width: 100%;
            max-width: 100%;
            box-sizing: border-box;
        }

        #Main .swiper-slide {
            width: 100% !important;
            max-width: 100% !important;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            box-sizing: border-box;
        }

        #Main .page-grid {
            display: grid;
            gap: 15px;
            height: 100%;
            padding: 0;
            box-sizing: border-box;
            align-content: center;
            justify-content: center;
            max-width: 100%;
        }

        /* Swiper Pagination */
        .swiper-pagination {
            position: relative !important;
            bottom: auto !important;
            margin-top: 20px;
            display: flex;
            justify-content: center;
            gap: 8px;
        }

        .swiper-pagination-bullet {
            width: 8px !important;
            height: 8px !important;
            border-radius: 50% !important;
            background: rgba(255, 255, 255, 0.3) !important;
            border: 1px solid var(--bi-secondary) !important;
            cursor: pointer !important;
            transition: all 0.3s ease !important;
            opacity: 1 !important;
        }

        .swiper-pagination-bullet-active {
            background: var(--bi-secondary) !important;
            transform: scale(1.2) !important;
        }

        .swiper-pagination-bullet:hover {
            background: rgba(0, 228, 124, 0.6) !important;
        }

        /* No apps message */
        .no-apps {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100%;
            color: var(--bi-primary);
            font-size: 16px;
            font-weight: 600;
        }

        .app-item {
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        .app-card {
            background: rgba(255, 255, 255, 0.95);
            border: 2px solid var(--bi-warm-gray);
            transition: all 0.3s ease;
            text-decoration: none;
            color: var(--bi-dark-green);
            /* Height will be set dynamically via JavaScript */
            display: flex;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: 8px;
            margin: 0 auto;
            /* Center the card horizontally within grid cell */
        }

        .app-card .card-body {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            padding: 15px 8px;
        }

        .app-card:hover {
            border-color: var(--bi-accent-green);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 228, 124, 0.3);
            color: var(--bi-dark-green);
            text-decoration: none;
            background: rgba(255, 255, 255, 0.98);
        }

        .app-icon {
            width: 48px !important;
            height: 48px !important;
            object-fit: cover;
            object-position: center;
            margin-bottom: 8px;
            flex-shrink: 0;
            display: block;
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
        }

        #Main .row {
            display: flex;
            justify-content: center;
            width: 100%;
        }

        #Main .row ul {
            list-style: none;
            margin: 0;
            padding: 0;
            display: grid;
            gap: 16px;
            width: 100%;
            max-width: 600px;
            justify-content: start;
            align-content: start;
            /* Grid template will be set dynamically via JavaScript */
        }

        #Main .row ul li {
            background: rgba(255, 255, 255, 0.95);
            border: 2px solid var(--bi-neutral);
            border-radius: 12px;
            transition: all 0.3s ease;
            text-align: center;
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            padding: 12px;
        }

        #Main .row ul li:hover {
            border-color: var(--bi-secondary);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 228, 124, 0.3);
            background: rgba(255, 255, 255, 0.98);
        }

        #Main .row ul li img {
            border: 0;
            object-fit: contain;
            margin-bottom: 8px;
        }

        #Main .row ul li .txt {
            color: var(--bi-primary);
            font-weight: 600;
            font-size: 12px;
            text-align: center;
            padding: 0 8px;
            line-height: 1.2;
        }

        /* Footer with BI Branding */
        #Footer {
            background: var(--bi-primary);
            border-top: 3px solid var(--bi-secondary);
            position: fixed;
            bottom: 0;
            width: 100%;
            z-index: 100;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 8px 16px;
        }

        #Footer .Title {
            color: var(--bi-secondary);
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        #Footer .badge {
            background: var(--bi-secondary);
            color: var(--bi-primary);
            padding: 4px 12px;
            border-radius: 16px;
            font-size: 11px;
            font-weight: bold;
        }

        #Footer img {
            height: 32px;
            width: auto;
            margin: 0 8px;
        }

        /* Responsive Design */
        @media screen and (orientation:portrait) {
            #portraitContent {
                display: block;
            }

            #landscapeContent {
                display: none;
            }

            #Header {
                height: 60px;
            }

            #Header .Title {
                font-size: 18px;
            }

            #Footer {
                height: 50px;
            }

            #Footer .Title {
                font-size: 12px;
            }

            #Main .content-wrapper {
                padding: 80px 20px 70px;
                min-height: 100vh;
            }

            #Main .row ul li {
                width: 140px;
                height: 140px;
                padding: 12px;
            }

            #Main .row ul li img {
                width: 64px;
                height: 64px;
            }

            #Main .row ul li .txt {
                font-size: 13px;
            }
        }

        @media screen and (orientation:landscape) {
            #portraitContent {
                display: none;
            }

            #landscapeContent {
                display: block;
            }

            #Header {
                height: 45px;
            }

            #Header .Title {
                font-size: 16px;
            }

            #Footer {
                height: 35px;
            }

            #Footer .Title {
                font-size: 10px;
            }

            #Main .content-wrapper {
                padding: 60px 15px 50px;
                min-height: 100vh;
            }

            #Main .row ul li {
                width: 120px;
                height: 120px;
                padding: 8px;
            }

            #Main .row ul li img {
                width: 56px;
                height: 56px;
            }

            #Main .row ul li .txt {
                font-size: 12px;
            }

            /* Landscape Swiper adjustments */
            #Main .page-grid {
                gap: 10px !important;
            }
        }

        /* Animation for status indicator */
        .status-dot {
            width: 8px;
            height: 8px;
            background: var(--bi-secondary);
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {

            0%,
            100% {
                opacity: 1;
            }

            50% {
                opacity: 0.5;
            }
        }

        /* Device Info Modal Styling */
        .device-info-modal .modal-content {
            background: var(--bi-surface);
            border: 2px solid var(--bi-secondary);
            border-radius: 12px;
        }

        .device-info-modal .modal-header {
            background: var(--bi-primary);
            color: var(--bi-secondary);
            border-bottom: 2px solid var(--bi-secondary);
        }

        .device-info-modal .modal-title {
            font-weight: bold;
        }

        .device-info-modal .btn-close {
            filter: invert(1);
        }

        .device-info-modal .modal-body {
            max-height: 400px;
            padding: 20px;
        }

        .device-info-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid var(--bi-neutral);
        }

        .device-info-item:last-child {
            border-bottom: none;
        }

        .device-info-label {
            font-weight: 600;
            color: var(--bi-primary);
            min-width: 120px;
        }

        .device-info-value {
            color: var(--bi-primary);
            text-align: right;
            word-break: break-all;
            max-width: 200px;
        }

        .device-info-modal .modal-footer {
            border-top: 2px solid var(--bi-secondary);
            background: var(--bi-neutral);
        }

        .device-info-modal .btn-outline-secondary {
            border-color: var(--bi-primary);
            color: var(--bi-primary);
        }

        .device-info-modal .btn-outline-secondary:hover {
            background: var(--bi-primary);
            border-color: var(--bi-primary);
            color: white;
        }

        /* Category headers */
        .device-info-category {
            color: var(--bi-primary);
            font-weight: bold;
            margin: 16px 0 8px 0;
            padding-bottom: 4px;
            border-bottom: 2px solid var(--bi-secondary);
        }

        .device-info-category:first-child {
            margin-top: 0;
        }
    </style>
</head>

<body>
    <div id="wrapper">
        <div id="Header"></div>
        <div id="portraitContent"></div>
        <div id="landscapeContent"></div>
        <div id="Footer"></div>
    </div>

    <!-- Device Info Modal -->
    <div class="modal fade device-info-modal" id="deviceInfoModal" tabindex="-1" aria-labelledby="deviceInfoModalLabel"
        aria-hidden="true">
        <div class="modal-dialog modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="deviceInfoModalLabel">
                        <i class="bi bi-device-ssd me-2"></i>
                        Device Information
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <!-- DEVICE_INFO_CONTENT_PLACEHOLDER -->
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-outline-secondary" data-bs-dismiss="modal">
                        <i class="bi bi-x-circle me-1"></i>
                        Close
                    </button>
                </div>
            </div>
        </div>
    </div>



    <!-- BOOTSTRAP_JS_PLACEHOLDER -->
    <!-- SWIPER_JS_PLACEHOLDER -->

    <script>
        // SOTI Template
        // Enhanced version of SOTI's dynamic template system

        // Grid Configuration from config.json
        var gridConfig = GRID_CONFIG_PLACEHOLDER;

        var main_row_ul_li_height, main_row_ul_li_img, main_row_ul_li_txt, main_row_ul_li_width;
        var HTMLheader, HTMLfooter, IconCount;
        var SotiLink = [], SotiImg = [], SotiDisp = [], SotiDispImg = [], SotiExeImg = [];

        // Declare Swiper variables at the top level
        let currentSwiper = null;

        // Initialize everything
        SotiLinkCheck();
        CSSOrientationSetup();
        HTMLtablesetup();
        createSwiperPages();

        // Handle orientation change
        window.addEventListener('orientationchange', function () {
            setTimeout(() => {
                createSwiperPages();
            }, 100);
        });

        // Update the resize event to use Swiper instead of grid layout
        window.addEventListener('resize', function () {
            setTimeout(() => {
                createSwiperPages();
            }, 100);
        });

        function SotiLinkCheck() {
            var Count, SotiValidate;
            HTMLheader = "";
            HTMLfooter = "";
            IconCount = 0;
            HeaderCheck = 1; // Always show BI header
            FooterCheck = 1; // Always show BI footer

            // Load all SOTI variables into arrays (0-19 for maximum compatibility)
            SotiLink[0] = "<MCLink0>"; SotiDisp[0] = "<MCDISP0>"; SotiExeImg[0] = "<MCExeIcon0>"; SotiDispImg[0] = "<MCDispImg0>";
            SotiLink[1] = "<MCLink1>"; SotiDisp[1] = "<MCDISP1>"; SotiExeImg[1] = "<MCExeIcon1>"; SotiDispImg[1] = "<MCDispImg1>";
            SotiLink[2] = "<MCLink2>"; SotiDisp[2] = "<MCDISP2>"; SotiExeImg[2] = "<MCExeIcon2>"; SotiDispImg[2] = "<MCDispImg2>";
            SotiLink[3] = "<MCLink3>"; SotiDisp[3] = "<MCDISP3>"; SotiExeImg[3] = "<MCExeIcon3>"; SotiDispImg[3] = "<MCDispImg3>";
            SotiLink[4] = "<MCLink4>"; SotiDisp[4] = "<MCDISP4>"; SotiExeImg[4] = "<MCExeIcon4>"; SotiDispImg[4] = "<MCDispImg4>";
            SotiLink[5] = "<MCLink5>"; SotiDisp[5] = "<MCDISP5>"; SotiExeImg[5] = "<MCExeIcon5>"; SotiDispImg[5] = "<MCDispImg5>";
            SotiLink[6] = "<MCLink6>"; SotiDisp[6] = "<MCDISP6>"; SotiExeImg[6] = "<MCExeIcon6>"; SotiDispImg[6] = "<MCDispImg6>";
            SotiLink[7] = "<MCLink7>"; SotiDisp[7] = "<MCDISP7>"; SotiExeImg[7] = "<MCExeIcon7>"; SotiDispImg[7] = "<MCDispImg7>";
            SotiLink[8] = "<MCLink8>"; SotiDisp[8] = "<MCDISP8>"; SotiExeImg[8] = "<MCExeIcon8>"; SotiDispImg[8] = "<MCDispImg8>";
            SotiLink[9] = "<MCLink9>"; SotiDisp[9] = "<MCDISP9>"; SotiExeImg[9] = "<MCExeIcon9>"; SotiDispImg[9] = "<MCDispImg9>";
            SotiLink[10] = "<MCLink10>"; SotiDisp[10] = "<MCDISP10>"; SotiExeImg[10] = "<MCExeIcon10>"; SotiDispImg[10] = "<MCDispImg10>";
            SotiLink[11] = "<MCLink11>"; SotiDisp[11] = "<MCDISP11>"; SotiExeImg[11] = "<MCExeIcon11>"; SotiDispImg[11] = "<MCDispImg11>";
            SotiLink[12] = "<MCLink12>"; SotiDisp[12] = "<MCDISP12>"; SotiExeImg[12] = "<MCExeIcon12>"; SotiDispImg[12] = "<MCDispImg12>";
            SotiLink[13] = "<MCLink13>"; SotiDisp[13] = "<MCDISP13>"; SotiExeImg[13] = "<MCExeIcon13>"; SotiDispImg[13] = "<MCDispImg13>";
            SotiLink[14] = "<MCLink14>"; SotiDisp[14] = "<MCDISP14>"; SotiExeImg[14] = "<MCExeIcon14>"; SotiDispImg[14] = "<MCDispImg14>";
            SotiLink[15] = "<MCLink15>"; SotiDisp[15] = "<MCDISP15>"; SotiExeImg[15] = "<MCExeIcon15>"; SotiDispImg[15] = "<MCDispImg15>";
            SotiLink[16] = "<MCLink16>"; SotiDisp[16] = "<MCDISP16>"; SotiExeImg[16] = "<MCExeIcon16>"; SotiDispImg[16] = "<MCDispImg16>";
            SotiLink[17] = "<MCLink17>"; SotiDisp[17] = "<MCDISP17>"; SotiExeImg[17] = "<MCExeIcon17>"; SotiDispImg[17] = "<MCDispImg17>";
            SotiLink[18] = "<MCLink18>"; SotiDisp[18] = "<MCDISP18>"; SotiExeImg[18] = "<MCExeIcon18>"; SotiDispImg[18] = "<MCDispImg18>";
            SotiLink[19] = "<MCLink19>"; SotiDisp[19] = "<MCDISP19>"; SotiExeImg[19] = "<MCExeIcon19>"; SotiDispImg[19] = "<MCDispImg19>";

            // Count valid apps and set up images
            for (var index = 0; index < 20; index++) {
                var SotiValidate = SotiLink[index].search("MCLink");
                if (SotiDisp[index] != "HIDDEN") {
                    if (SotiValidate === -1) {
                        // Choose image: custom display image or exe icon
                        if (SotiDispImg[index] === "") {
                            SotiImg[index] = SotiExeImg[index];
                        } else {
                            SotiImg[index] = SotiDispImg[index];
                        }
                        IconCount++;
                    } else {
                        SotiLink.length = index;
                        break;
                    }
                }
            }

            // Create BI Header with base64 logo
            var logoBase64 = "LOGO_BASE64_PLACEHOLDER";
            HTMLheader = '<img src="' + logoBase64 + '" style="width: 40px; height: 40px; border-radius: 6px;" alt="BI Logo"><span class="Title">HEADER_TEXT_PLACEHOLDER</span><button class="info-btn" data-bs-toggle="modal" data-bs-target="#deviceInfoModal" title="Device Information" aria-label="Show Device Information"><i class="bi bi-info-circle-fill"></i></button>';
            HTMLfooter = '<div class="Title"><div class="status-dot"></div>FOOTER_TEXT_PLACEHOLDER</div><div class="badge">FOOTER_BADGE_PLACEHOLDER</div>';
        }

        function CSSOrientationSetup() {
            // Dynamic sizing will be handled by applyGridLayout function
            console.log('CSS orientation setup complete. Icon count:', IconCount);
        }

        function HTMLtablesetup() {
            // Use Swiper structure with wrapper for both orientations
            var PortraitHTML = '<div id="Main"><div class="content-wrapper"><div class="swiper-container-wrapper"><div class="swiper" id="portraitSwiper"><div class="swiper-wrapper" id="portraitSwiperWrapper"></div><div class="swiper-pagination"></div></div></div></div></div>';
            var LandscapeHTML = '<div id="Main"><div class="content-wrapper"><div class="swiper-container-wrapper"><div class="swiper" id="landscapeSwiper"><div class="swiper-wrapper" id="landscapeSwiperWrapper"></div><div class="swiper-pagination"></div></div></div></div></div>';

            document.getElementById("portraitContent").innerHTML = PortraitHTML;
            document.getElementById("landscapeContent").innerHTML = LandscapeHTML;
            document.getElementById("Header").innerHTML = HTMLheader;
            document.getElementById("Footer").innerHTML = HTMLfooter;
        }

        // Helper function to get current orientation containers
        function getCurrentContainers() {
            const isLandscape = window.innerWidth > window.innerHeight;
            const containerPrefix = isLandscape ? 'landscape' : 'portrait';
            const swiperId = `${containerPrefix}Swiper`;
            const swiperWrapperId = `${containerPrefix}SwiperWrapper`;

            const swiperContainer = document.getElementById(swiperId);
            const swiperWrapper = document.getElementById(swiperWrapperId);

            return {
                swiperContainer: swiperContainer,
                swiperWrapper: swiperWrapper,
                isLandscape: isLandscape
            };
        }

        function calculateOptimalAppSize(gridColumns, gridRows) {
            // Calculate available space for apps accounting for actual container padding
            const headerHeight = 40; // Header height
            const footerHeight = 36; // Footer height
            const pageGap = 15; // Gap between grid items
            const contentWrapperPadding = 40; // 20px on each side of content-wrapper
            const swiperPadding = 20; // Additional internal swiper padding
            const pageIndicatorHeight = 40; // Space for page indicators

            // Calculate available viewport dimensions - accounting for ALL padding layers
            const availableWidth = window.innerWidth - contentWrapperPadding - swiperPadding;
            const availableHeight = window.innerHeight - headerHeight - footerHeight - pageIndicatorHeight - contentWrapperPadding;

            // Calculate grid item dimensions
            const totalHorizontalGaps = (gridColumns - 1) * pageGap;
            const totalVerticalGaps = (gridRows - 1) * pageGap;

            const maxItemWidth = (availableWidth - totalHorizontalGaps) / gridColumns;
            const maxItemHeight = (availableHeight - totalVerticalGaps) / gridRows;

            // Conservative sizing to ensure no overflow
            const minItemSize = 70;
            const optimalWidth = Math.max(minItemSize, Math.floor(maxItemWidth * 0.85));
            const optimalHeight = Math.max(minItemSize, Math.floor(maxItemHeight * 0.85));

            console.log(`Viewport: ${window.innerWidth}x${window.innerHeight}`);
            console.log(`Available space: ${availableWidth}x${availableHeight}`);
            console.log(`Grid ${gridColumns}x${gridRows}, optimal item size: ${optimalWidth}x${optimalHeight}`);

            return {
                width: optimalWidth,
                height: optimalHeight,
                iconSize: 48, // Fixed icon size for consistency
                fontSize: Math.max(10, Math.min(14, optimalHeight * 0.1)) // Readable font size
            };
        }

        function createSwiperPages() {
            const deviceType = window.innerWidth <= 600 ? 'mobile' : 'tablet';
            const gridColumns = gridConfig.gridColumns[deviceType];
            const gridRows = gridConfig.gridRows[deviceType];
            const appsPerPage = gridColumns * gridRows;

            // Calculate optimal app dimensions
            const appDimensions = calculateOptimalAppSize(gridColumns, gridRows);

            // Get current orientation containers
            const { swiperContainer, swiperWrapper, isLandscape } = getCurrentContainers();

            if (!swiperContainer || !swiperWrapper) {
                console.error('Swiper containers not found');
                return;
            }

            console.log(`Creating Swiper pages for ${deviceType} device (${isLandscape ? 'landscape' : 'portrait'})`);

            // Get all SOTI apps (0-19)
            const allApps = [];
            for (let i = 0; i < 20; i++) {
                if (SotiDisp[i] &&
                    SotiDisp[i] !== "HIDDEN" &&
                    SotiDisp[i].trim() !== "" &&
                    !SotiDisp[i].includes('<MCDISP') &&
                    !SotiDisp[i].includes('MCLink')) {
                    allApps.push({
                        index: i,
                        link: SotiLink[i] || `javascript:void(0)`,
                        image: SotiImg[i] || '',
                        display: SotiDisp[i]
                    });
                }
            }

            console.log(`Found ${allApps.length} valid apps for ${deviceType} device`);
            console.log(`Grid: ${gridColumns}x${gridRows} = ${appsPerPage} apps per page`);

            if (allApps.length === 0) {
                swiperWrapper.innerHTML = '<div class="swiper-slide"><div class="no-apps">No apps available</div></div>';
                return;
            }

            // Calculate pages needed
            const totalPages = Math.ceil(allApps.length / appsPerPage);
            console.log(`Creating ${totalPages} Swiper slides`);

            // Clear existing content
            swiperWrapper.innerHTML = '';

            // Create each page as a Swiper slide
            for (let pageIndex = 0; pageIndex < totalPages; pageIndex++) {
                const slide = document.createElement('div');
                slide.className = 'swiper-slide';

                const pageGrid = document.createElement('div');
                pageGrid.className = 'page-grid';
                pageGrid.style.display = 'grid';
                pageGrid.style.gridTemplateColumns = `repeat(${gridColumns}, 1fr)`;
                pageGrid.style.gridTemplateRows = `repeat(${gridRows}, 1fr)`;
                pageGrid.style.gap = '15px';
                pageGrid.style.height = '100%';

                // Add apps to this page
                const startIndex = pageIndex * appsPerPage;
                const endIndex = Math.min(startIndex + appsPerPage, allApps.length);

                console.log(`Slide ${pageIndex + 1}: apps ${startIndex} to ${endIndex - 1}`);

                for (let i = startIndex; i < endIndex; i++) {
                    const app = allApps[i];
                    console.log(`  Adding app ${i}: "${app.display}" to slide ${pageIndex + 1}`);

                    const appElement = document.createElement('div');
                    appElement.className = 'app-item';
                    appElement.innerHTML = `
                        <a href="${app.link}" class="app-card card text-center">
                            <div class="card-body">
                                <img src="${app.image}" class="app-icon" alt="App" onerror="this.style.display='none'"/>
                                <p class="card-text small fw-semibold mb-0">
                                    ${app.display}
                                </p>
                            </div>
                        </a>
                    `;

                    // Apply dynamic sizing
                    const appCard = appElement.querySelector('.app-card');
                    const appIcon = appElement.querySelector('.app-icon');
                    const cardText = appElement.querySelector('.card-text');
                    const cardBody = appElement.querySelector('.card-body');

                    if (appCard) {
                        appCard.style.height = `${appDimensions.height}px`;
                        appCard.style.width = `${appDimensions.width}px`;
                        appCard.style.maxWidth = `${appDimensions.width}px`;
                    }

                    if (cardBody) {
                        const dynamicPadding = Math.max(6, Math.min(15, appDimensions.height * 0.1));
                        cardBody.style.padding = `${dynamicPadding}px ${Math.max(6, dynamicPadding * 0.7)}px`;
                    }

                    if (appIcon) {
                        // Remove dynamic sizing - rely on CSS for consistent icon sizes
                        appIcon.style.marginBottom = `${Math.max(4, appDimensions.height * 0.05)}px`;
                    }

                    if (cardText) {
                        cardText.style.fontSize = `${appDimensions.fontSize}px`;
                        cardText.style.lineHeight = '1.2';
                        cardText.style.wordWrap = 'break-word';
                        cardText.style.overflowWrap = 'break-word';
                        cardText.style.hyphens = 'auto';
                        cardText.style.maxHeight = `${appDimensions.height * 0.3}px`;
                        cardText.style.overflow = 'hidden';
                        cardText.style.display = '-webkit-box';
                        cardText.style.webkitLineClamp = '2';
                        cardText.style.webkitBoxOrient = 'vertical';
                    }

                    pageGrid.appendChild(appElement);
                }

                slide.appendChild(pageGrid);
                swiperWrapper.appendChild(slide);
                console.log(`Slide ${pageIndex + 1} created with ${pageGrid.children.length} apps`);
            }

            console.log(`Total slides created: ${swiperWrapper.children.length}`);

            // Initialize or update Swiper
            initializeSwiper();
        }

        function initializeSwiper() {
            const { swiperContainer, isLandscape } = getCurrentContainers();

            if (!swiperContainer) {
                console.error('Swiper container not found');
                return;
            }

            // Destroy existing Swiper instance if it exists
            if (currentSwiper) {
                currentSwiper.destroy(true, true);
                currentSwiper = null;
            }

            console.log('Initializing Swiper for', isLandscape ? 'landscape' : 'portrait');

            // Initialize new Swiper
            currentSwiper = new Swiper(swiperContainer, {
                slidesPerView: 1,
                spaceBetween: 0,
                loop: false,
                centeredSlides: false,

                // Enable touch and mouse navigation
                touchRatio: 1,
                touchAngle: 45,
                grabCursor: true,

                // Responsive breakpoints
                breakpoints: {
                    320: {
                        slidesPerView: 1,
                        spaceBetween: 0
                    },
                    768: {
                        slidesPerView: 1,
                        spaceBetween: 0
                    }
                },

                // Pagination
                pagination: {
                    el: swiperContainer.querySelector('.swiper-pagination'),
                    clickable: true,
                    bulletClass: 'swiper-pagination-bullet',
                    bulletActiveClass: 'swiper-pagination-bullet-active',
                    renderBullet: function (index, className) {
                        return '<span class="' + className + '"></span>';
                    }
                },

                // Performance optimizations
                watchSlidesProgress: true,
                watchSlidesVisibility: true,
                preloadImages: false,
                lazy: true,

                // Events
                on: {
                    slideChange: function () {
                        console.log('Slide changed to:', this.activeIndex);
                    },
                    resize: function () {
                        this.update();
                    }
                }
            });

            console.log('Swiper initialized successfully with', currentSwiper.slides.length, 'slides');
            return currentSwiper;
        }








        console.log('Apps detected:', IconCount);
    </script>

</html>